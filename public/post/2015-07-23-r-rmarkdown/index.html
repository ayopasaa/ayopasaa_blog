<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.3.1">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Alejandro Yopasá Arenas">

  
  
  
    
  
  <meta name="description" content="Predicted relative standard deviation of the reproducibility (PRSD(R)), the “Horwitz Trumpet”.Based on the results of thousands of interlaboratory method performance studies, Dr William Horwitz calculates the estimates of the repeatability and reproducibility (between laboratory) standard deviations. He noticed that as the concentration of the analyte decreased over two orders of magnitude, the relative standard deviation of reproducibility (RSDR) increased by a factor of two. This pattern persisted at least down to sub-ppm levels.">

  
  <link rel="alternate" hreflang="en-us" href="/post/2015-07-23-r-rmarkdown/">

  


  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.e2f43c4e621c76c264988f66a867d2af.css">

  

  
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/2015-07-23-r-rmarkdown/">

  
  
  
  
    
    
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Alejandro Yopasá Arenas">
  <meta property="og:url" content="/post/2015-07-23-r-rmarkdown/">
  <meta property="og:title" content="Predicted relative standard deviation of the reproducibility (PRSD(R)), the “Horwitz Trumpet | Alejandro Yopasá Arenas">
  <meta property="og:description" content="Predicted relative standard deviation of the reproducibility (PRSD(R)), the “Horwitz Trumpet”.Based on the results of thousands of interlaboratory method performance studies, Dr William Horwitz calculates the estimates of the repeatability and reproducibility (between laboratory) standard deviations. He noticed that as the concentration of the analyte decreased over two orders of magnitude, the relative standard deviation of reproducibility (RSDR) increased by a factor of two. This pattern persisted at least down to sub-ppm levels."><meta property="og:image" content="/img/icon-192.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-09-17T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2019-09-17T00:00:00&#43;00:00">
  

  

  

  <title>Predicted relative standard deviation of the reproducibility (PRSD(R)), the “Horwitz Trumpet | Alejandro Yopasá Arenas</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Alejandro Yopasá Arenas</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/">
            
            <span>Courses</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Curriculim_Vitae_Alejandro_Yopasa_pt_en.pdf">
            
            <span>CV</span>
            
          </a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Predicted relative standard deviation of the reproducibility (PRSD(R)), the “Horwitz Trumpet</h1>

  

  
    



<meta content="2019-09-17 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2019-09-17 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>Sep 17, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    3 min read
  </span>
  

  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    <a href="/categories/r/">R</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=&amp;url="
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u="
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=&amp;title="
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=&amp;title="
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=&amp;body=">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<div id="predicted-relative-standard-deviation-of-the-reproducibility-prsdr-the-horwitz-trumpet." class="section level1">
<h1>Predicted relative standard deviation of the reproducibility (PRSD(R)), the “Horwitz Trumpet”.</h1>
<p>Based on the results of thousands of interlaboratory method performance studies, Dr William Horwitz calculates the estimates of the repeatability and reproducibility (between laboratory) standard deviations. He noticed that as the concentration of the analyte decreased over two orders of magnitude, the relative standard deviation of reproducibility (RSD<sub>R</sub>) increased by a factor of two. This pattern persisted at least down to sub-ppm levels. These findings gave rise to the famous ‘Horwitz Trumpet’, which depicts the relationship expressed as a two-sided one-sigma confidence interval. The predicted reproducibility standard deviation <span class="math inline">\(\sigma_R\)</span> in function of the concentration <span class="math inline">\(C\)</span>, expressed as mass ratio (decimal fraction), is expresed by:</p>
<p><span class="math display">\[
\sigma_R = 0.02 C^{0.8495} \qquad or \qquad log_{10} \sigma_R = 0.8495 log_{10} C -1.6990
\]</span></p>
<p>The predicted relative standard deviation expressed as percentage (%), is calculated as:</p>
<p><span class="math display">\[
PRSD_R(\%)= \frac{\sigma_R}{C} \times 100 \qquad so \qquad PRSD_R(\%)= 2 \times C^{0.8495}C^{-1} = 2C^{-0.1505}
\]</span></p>
<p>In guidelines for standard methods requeriments of the AOAC this PRSD<sub>R</sub> is a measure of the <em>reproducibility</em> from among-laboratory data. And the <em>repeatability</em>, or within-laboratory acceptable predicted target values for repeatability (PRSD<sub>r</sub>) are calculated as <span class="math inline">\(PRSD_r(\%)=PRSD_R(\%)/2\)</span>, which represents the best case.</p>
<div id="calculation" class="section level2">
<h2>Calculation</h2>
<p>For calculating and reporting statistical parameters, data may be expressed in any convenient units (e.g., %, ppm, ppb, mg g<sup>-1</sup>, μg g<sup>-1</sup>; μg kg<sup>-1</sup>; μg L<sup>-1</sup>, μg μL<sup>-1</sup>, etc.). For reporting HorRat values, or for calculation or the PRSD(R) data must be reported as a mass fraction, where the units of the numerator and denominator are the same, for example:</p>
<p><span class="math display">\[
1 \%= \frac{1 g}{100 g}= 0.01; \qquad \qquad 1 ppm=\frac{1 mg}{1 kg}=\frac{1 mg}{1000000 mg}= 0.000001
\]</span></p>
<p>We can create a R function to calculate the PRSD<sub>R</sub> as follows:</p>
<pre class="r"><code>PRSDR&lt;-function(conc, unit){
  # Converting to mass ratio units
  if (unit== &quot;massratio&quot;) {
    mr=conc
  } else if (unit== &quot;percentage&quot;) {
    mr=conc/100
  } else if (unit== &quot;%&quot;) {
    mr=conc/100
  } else if (unit== &quot;ppm&quot;) {
    mr=conc/1000000
  } else if (unit== &quot;ppb&quot;) {
    mr=conc/1000000000
  } else if (unit== &quot;ppt&quot;) {
    mr=conc/1000000000000
  } else {
    warning(&quot;Please define one Concentration Unit: massratio, %, percentage, ppm, ppb,
          ppt&quot;)
  }

  # Compute the Horwitz reproducibility standard deviation
  2*(mr^-0.1505)

}</code></pre>
<p>So, using the formula we can graph the Horwitz curve from the concentration of a pure material (100 %, mass ratio= 1) to the concentration range of for example trace pollutants (1 ppb, mass ratio= 10^{-9}), the concentration in x is expressed as logarithm.</p>
<pre class="r"><code>conc &lt;- seq(from = log10(1e-9), to = log10(1), length.out = 100)

PRSDR_R &lt;- PRSDR(10^(conc), &quot;massratio&quot;)

Hor_tru &lt;- data.frame(conc, PRSDR_R)

library(ggplot2)

events &lt;- data.frame(conc2 = c(log10(1),
                               log10(0.1),
                               log10(0.01),
                               log10(0.001),
                               log10(100/1e6),
                               log10(10/1e6),
                               log10(1/1e6),
                               log10(100/1e9),
                               log10(10/1e9),
                               log10(1/1e9)),
                     text = c(&#39;100 %&#39;,
                              &quot;10 %&quot;,
                              &#39;1 %&#39;,
                              &quot;0.1%&quot;,
                              &quot;100 ppm&quot;,
                              &quot;10 ppm&quot;,
                              &quot;1 ppm&quot;,
                              &quot;100 ppb&quot;,
                              &quot;10 ppb&quot;,
                              &quot;1 ppb&quot;))

p&lt;-ggplot(Hor_tru, aes(x=conc, y=PRSDR_R))+
  geom_line(aes(color=&quot;Reproducibility&quot;))+
  geom_line(aes(y=-PRSDR_R, color=&quot;Reproducibility&quot;))+
  geom_line(aes(y= PRSDR_R/2, color=&quot;Repeatability&quot;))+
  geom_line(aes(y=-PRSDR_R/2, color=&quot;Repeatability&quot;))+
  geom_vline(data = events, aes(xintercept = conc2), linetype=2, color=&quot;gray70&quot;)+
  geom_text(data = events, mapping = aes(label = text, x=conc2, y=-47), angle = 90, hjust = 0, vjust= 1)+
  xlab(expression(Log[10](mass~ratio)))+
  ylab(expression(Predicted~relative~standard~deviation-PRSD~(&quot;%&quot;)))+
  theme_light()+
  theme(legend.title = element_blank())
p</code></pre>
<p><img src="/post/2015-07-23-r-rmarkdown_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The Horwitz curve is useful as the initial estimate of expected among-laboratory variability prior to the performance of an interlaboratory study</p>
</div>
</div>

    </div>

    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/r-markdown/">R Markdown</a>
  
  <a class="badge badge-light" href="/tags/horwitz/">horwitz</a>
  
  <a class="badge badge-light" href="/tags/precission/">precission</a>
  
</div>



    
      








  





  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu66856b498686ee1cc65495b86c06a655_279091_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/authors/admin/">Alejandro Yopasá Arenas</a></h5>
      <h6 class="card-subtitle">PhD candidate</h6>
      <p class="card-text" itemprop="description">My research interests include analytical chemistry, data science and reproducible research.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://www.facebook.com/" target="_blank" rel="noopener">
              <i class="fab fa-facebook"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/ayopasaa" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
    

    

    


  </div>
</article>

<div class="container">
  <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/privacy/">Privacy Policy</a>
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
      

      
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.8f3d53582b3c04a038fca31bcc86151b.js"></script>

  </body>
</html>

