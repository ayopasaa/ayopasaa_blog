---
title: "Predicted relative standard deviation of the reproducibility (PRSD(R)), the “Horwitz Trumpet"
author: "Alejandro Yopasa"
date: "2019-09-17T00:00:00Z"
categories: ["R"]
tags: ["R Markdown", "horwitz", "precission"]
---



<div id="predicted-relative-standard-deviation-of-the-reproducibility-prsdr-the-horwitz-trumpet." class="section level1">
<h1>Predicted relative standard deviation of the reproducibility (PRSD(R)), the “Horwitz Trumpet”.</h1>
<p>Based on the results of thousands of interlaboratory method performance studies, Dr William Horwitz calculates the estimates of the repeatability and reproducibility (between laboratory) standard deviations. He noticed that as the concentration of the analyte decreased over two orders of magnitude, the relative standard deviation of reproducibility (RSD<sub>R</sub>) increased by a factor of two. This pattern persisted at least down to sub-ppm levels. These findings gave rise to the famous ‘Horwitz Trumpet’, which depicts the relationship expressed as a two-sided one-sigma confidence interval. The predicted reproducibility standard deviation <span class="math inline">\(\sigma_R\)</span> in function of the concentration <span class="math inline">\(C\)</span>, expressed as mass ratio (decimal fraction), is expresed by:</p>
<p><span class="math display">\[
\sigma_R = 0.02 C^{0.8495} \qquad or \qquad log_{10} \sigma_R = 0.8495 log_{10} C -1.6990
\]</span></p>
<p>The predicted relative standard deviation expressed as percentage (%), is calculated as:</p>
<p><span class="math display">\[
PRSD_R(\%)= \frac{\sigma_R}{C} \times 100 \qquad so \qquad PRSD_R(\%)= 2 \times C^{0.8495}C^{-1} = 2C^{-0.1505}
\]</span></p>
<p>In guidelines for standard methods requeriments of the AOAC this PRSD<sub>R</sub> is a measure of the <em>reproducibility</em> from among-laboratory data. And the <em>repeatability</em>, or within-laboratory acceptable predicted target values for repeatability (PRSD<sub>r</sub>) are calculated as <span class="math inline">\(PRSD_r(\%)=PRSD_R(\%)/2\)</span>, which represents the best case.</p>
<div id="calculation" class="section level2">
<h2>Calculation</h2>
<p>For calculating and reporting statistical parameters, data may be expressed in any convenient units (e.g., %, ppm, ppb, mg g<sup>-1</sup>, μg g<sup>-1</sup>; μg kg<sup>-1</sup>; μg L<sup>-1</sup>, μg μL<sup>-1</sup>, etc.). For reporting HorRat values, or for calculation or the PRSD(R) data must be reported as a mass fraction, where the units of the numerator and denominator are the same, for example:</p>
<p><span class="math display">\[
1 \%= \frac{1 g}{100 g}= 0.01; \qquad \qquad 1 ppm=\frac{1 mg}{1 kg}=\frac{1 mg}{1000000 mg}= 0.000001
\]</span></p>
<p>We can create a R function to calculate the PRSD<sub>R</sub> as follows:</p>
<pre class="r"><code>PRSDR&lt;-function(conc, unit){
  # Converting to mass ratio units
  if (unit== &quot;massratio&quot;) {
    mr=conc
  } else if (unit== &quot;percentage&quot;) {
    mr=conc/100
  } else if (unit== &quot;%&quot;) {
    mr=conc/100
  } else if (unit== &quot;ppm&quot;) {
    mr=conc/1000000
  } else if (unit== &quot;ppb&quot;) {
    mr=conc/1000000000
  } else if (unit== &quot;ppt&quot;) {
    mr=conc/1000000000000
  } else {
    warning(&quot;Please define one Concentration Unit: massratio, %, percentage, ppm, ppb,
          ppt&quot;)
  }

  # Compute the Horwitz reproducibility standard deviation
  2*(mr^-0.1505)

}</code></pre>
<p>So, using the formula we can graph the Horwitz curve from the concentration of a pure material (100 %, mass ratio= 1) to the concentration range of for example trace pollutants (1 ppb, mass ratio= 10^{-9}), the concentration in x is expressed as logarithm.</p>
<pre class="r"><code>conc &lt;- seq(from = log10(1e-9), to = log10(1), length.out = 100)

PRSDR_R &lt;- PRSDR(10^(conc), &quot;massratio&quot;)

Hor_tru &lt;- data.frame(conc, PRSDR_R)

library(ggplot2)

events &lt;- data.frame(conc2 = c(log10(1),
                               log10(0.1),
                               log10(0.01),
                               log10(0.001),
                               log10(100/1e6),
                               log10(10/1e6),
                               log10(1/1e6),
                               log10(100/1e9),
                               log10(10/1e9),
                               log10(1/1e9)),
                     text = c(&#39;100 %&#39;,
                              &quot;10 %&quot;,
                              &#39;1 %&#39;,
                              &quot;0.1%&quot;,
                              &quot;100 ppm&quot;,
                              &quot;10 ppm&quot;,
                              &quot;1 ppm&quot;,
                              &quot;100 ppb&quot;,
                              &quot;10 ppb&quot;,
                              &quot;1 ppb&quot;))

p&lt;-ggplot(Hor_tru, aes(x=conc, y=PRSDR_R))+
  geom_line(aes(color=&quot;Reproducibility&quot;))+
  geom_line(aes(y=-PRSDR_R, color=&quot;Reproducibility&quot;))+
  geom_line(aes(y= PRSDR_R/2, color=&quot;Repeatability&quot;))+
  geom_line(aes(y=-PRSDR_R/2, color=&quot;Repeatability&quot;))+
  geom_vline(data = events, aes(xintercept = conc2), linetype=2, color=&quot;gray70&quot;)+
  geom_text(data = events, mapping = aes(label = text, x=conc2, y=-47), angle = 90, hjust = 0, vjust= 1)+
  xlab(expression(Log[10](mass~ratio)))+
  ylab(expression(Predicted~relative~standard~deviation-PRSD~(&quot;%&quot;)))+
  theme_light()+
  theme(legend.title = element_blank())
p</code></pre>
<p><img src="/post/2015-07-23-r-rmarkdown_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The Horwitz curve is useful as the initial estimate of expected among-laboratory variability prior to the performance of an interlaboratory study</p>
</div>
</div>
